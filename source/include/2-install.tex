% Copyright (C) 2018 by latexstudio <http://www.latexstudio.net>
%
% This program is free software: you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation, either version 3 of the License, or
% (at your option) any later version.
%
% This program is distributed in the hope that it will be useful,
% but WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
% GNU General Public License for more details.
%
% You should have received a copy of the GNU General Public License
% along with this program.  If not, see <http://www.gnu.org/licenses/>.
%

\section{安装与配置问题}
\label{sec:install}


\faq{如何安装 \LaTeX{}}{install-latex}

很多用户所谓的如何安装 \LaTeX{}，实际上是一个无解的问题，因为 \LaTeX{} 不是一款软件，
相关概念不再赘述。
用户可以直接安装 LaTeX 发行版，如 proTeXt , \TeXLive{} 和 \MacTeX{}
（\TeXLive{} 在 macOS 的一个再次发行版）。


\faq{如何下载 \TeXLive{} 安装包}{download-texlive}

访问以下网址获取 \TeXLive{} 安装包镜像文件：
\url{http://mirror.ctan.org/systems/texlive/Images/texlive.iso}

\MacTeX{} 安装包下载地址：
\url{http://mirror.ctan.org/systems/mac/mactex/MacTeX.pkg}


\faq{如何安装 \TeXLive{}}{install-texlive}

\TeXLive{} 为用户提供了官方安装手册，其中文版地址是：
\url{https://tug.org/texlive/doc/texlive-zh-cn/texlive-zh-cn.pdf}
建议有余力的用户通读手册，以了解更多内容。

也可以参照以下网址 \url{https://www.tug.org/texlive/quickinstall.html}


\faq{如何下载 proTeXt 安装包？}{download-protext}

访问以下链接即可 \url{http://mirror.ctan.org/systems/protext/protext.exe}


\faq{如何挂载镜像文件：}{mount-iso}

目前市面上有很多虚拟光驱软件可供用户选择，例如 UltraISO。

特别一提，在 Windows 8、Windows 10
操作系统中，默认被双击后，镜像文件将会直接挂载。

在 Linux 操作系统中，可使用命令行挂载镜像文件：
\begin{verbatim}
mount -o loop ~/download/texlive.iso ~/iso
\end{verbatim}


\faq{挂载镜像文件后该如何做？}{after-mount}

windows 用户可以双击 \file{install-tl-windows.bat} 文件来进行安装。

Linux 用户请在命令行执行 |./install-tl| 进入 no gui 安装模式


\faq{双击 install-tl-windows.bat 出现错误怎么办？}{error-install}

使用命令行。同时按下 win 键和 R 键，打开“运行”窗口，在窗口的“打开”处，
输入 cmd 打开命令行窗口（黑窗）。

在黑窗内输入
\begin{verbatim}
cd /d [~]
\end{verbatim}

后按 Enter 键（即执行该命令），此处 |~| 代指 \file{install-tl-windows.bat} 所在目录，
例如 \file{C:/Downloads} 等，注意命令中的空格。

进入目录后继续执行
\begin{verbatim}
install-tl-windows.bat -no-gui
\end{verbatim}

开启纯命令行安装模式。默认状态下，点击 I 键，安装便会开始。
若用户想改变安装路径或其他设置，只需根据屏幕提示进行更改即可。
特别强调，安装路径一定是不带空格的纯英文路径。


\faq{使用命令行安装 \TeXLive{} 出现 goodbye 怎么办？}{error-goodbye}

主要是缺少 CMD 所在的环境变量。 只需要在命令行中执行
\begin{verbatim}
path=%path%;C:\Windows\system32
\end{verbatim}
后再尝试安装。或者因为下载文件损坏，上述方法不管用应重新下载。


\faq{想在 Linux 系统中使用 GUI 模式安装该怎么做？}{linux-gui}

自行安装 perl，详细办法请上网自行搜索。然后执行命令
\begin{verbatim}
./install-tl -gui wizard
\end{verbatim}
或
\begin{verbatim}
./install-tl -gui perltk
\end{verbatim}


\faq{如何配置 \TeXLive{} 的环境变量？}{texlive-path}

Windows 用户一般不必担忧这个问题。因为 \TeXLive{} 已经自动将环境变量写入，用户不必自己手动修改。

Linux 用户需要手动配置环境变量。例如，将
\begin{verbatim}
TEXDIR=/usr/local/texlive/2018
if [ -d $TEXDIR ]; then
  export PATH="$TEXDIR/bin/x86_64-linux:$PATH";
  export MANPATH="$TEXDIR/texmf-dist/doc/man:$MANPATH";
  export INFOPATH="$TEXDIR/texmf-dist/doc/info:$INFOPATH";
fi;
\end{verbatim}
写入 \file{~/.profile}。注意本例中的 2018 可以根据需要修改。
例如部分用户还在使用 \TeXLive{} 2017，就可将 2018 改为 2017 等等。


\faq{如何判断 \TeXLive{} 安装成功？}{texlive-success}

在命令行中执行
\begin{verbatim}
tex -v
\end{verbatim}
若命令行窗口中显示“TeX Live 2018”等内容，即说明安装成功。


\faq{如何删除 \TeXLive{}}{uninstall-texlive}

Windows 用户请找卸载批命令文件，如 |C:\texlive\2018\tlpkg\installer\uninst.bat|

Linux 用户请直接删除文件夹，如执行
\begin{verbatim}
rm -rf /usr/local/texlive/2018
rm -rf ~/.texlive2018
\end{verbatim}
并且手动清理环境变量。


\faq{\TeXLive{} 如何升级宏包？}{texlive-update}

建议使用命令行升级宏包。

首先指定源，执行命令
\begin{verbatim}
tlmgr option repository ctan
\end{verbatim}
以自动寻求源，也可以手动指定源，例如执行命令
\begin{verbatim}
tlmgr option repository http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet
\end{verbatim}
即指定了源为 \url{http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet}。
接下来，执行命令
\begin{verbatim}
tlmgr update --self
\end{verbatim}

升级 tlmgr 本身。 然后，我们就可以升级宏包了。实际上，tlmgr
升级所有宏包的代码非常简单，执行命令
\begin{verbatim}
tlmgr update --all
\end{verbatim}

值得一提的是，这样的做法也会同时删除本地的那些已被我们设定的源所剔除的宏包。如果用户想保留它们的话，可以执行

\begin{verbatim}
tlmgr update --all --no-auto-remove
\end{verbatim}

但是 tlmgr
手册并不建议用户使用这样的方法。此外，为了防止更新后出现某些问题，我们还可以执行如下命令建立一个宏包备份：

\begin{verbatim}
tlmgr update --all --backup --backupdir E:\latexwork\backup
\end{verbatim}

通过这句代码，我们就可以在更新宏包前将需要更新的宏包备份在
|E:\latexwork\backup| 中。一旦更新出现问题，我们可以执行

\begin{verbatim}
tlmgr restore --bakeupdir E:\latexwork\backup --all
\end{verbatim}

来恢复全部宏包，或者我们也可以恢复某个宏包，如

\begin{verbatim}
tlmgr restore --bakeupdir E:\latexwork\backup mcmthesis
\end{verbatim}

就可以用于恢复 \pkg{mcmthesis}。


\faq{\MiKTeX{} 如何升级宏包}{miktex-update}

\MiKTeX{}
可以用界面升级宏包，有些用户经常升级失败是因为源不稳定造成的。建议到
\url{https://miktex.org/pkg/repositories} 找稳定的源。


\faq{\TeXLive{} 对源的操作有哪些}{texlive-repo}

查看源列表
\begin{verbatim}
tlmgr repository list
\end{verbatim}

正常情况下，列表中至少有一个源地址，并且该源地址被标记为 main。 添加源
\begin{verbatim}
tlmgr repository add <path> [tag]
\end{verbatim}

path 是源的地址，tag 是源的标签。例如添加
\url{http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet} 并标记为 thu
\begin{verbatim}
tlmgr repository add http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet thu
\end{verbatim}

标签可以省略 删除源
\begin{verbatim}
tlmgr repository remove path|tag
\end{verbatim}

例如将刚才添加的 thu 删除
\begin{verbatim}
tlmgr repository remove thu
\end{verbatim}

无视以前的列表，重新制定列表
\begin{verbatim}
tlmgr repository set path[#tag] [path[#tag] ...]
\end{verbatim}

特别强调，\TeXLive{} 要求源列表中至少存在一个被标记为 main
的源，否则一切操作都将失效。


\faq{如何自动升级 \TeXLive{} 宏包？}{texlive-autoupdate}

\href{http://pd10ibe5c.bkt.clouddn.com/TeXLive\%E5\%AE\%8F\%E5\%8C\%85\%E6\%AF\%8F\%E6\%9C\%88\%E8\%87\%AA\%E5\%8A\%A8\%E6\%9B\%B4\%E6\%96\%B0.zip}{这里可以下载每月自动升级\TeXLive{}宏包的脚本}。
\href{http://htharoldht.com/texlive-package-automatically-upgrades-every-month/}{这里是该脚本的说明}。
* 脚本源码

\begin{verbatim}
@echo off

if exist "C:\Windows\Tasks\AutoTeXLivePackageUpdaterMonthly.bat" goto run

move /y %0 "C:\Windows\Tasks"
schtasks /delete /tn "TeXLivePackage Updater Task" /f
schtasks /create /tn "TeXLivePackage Updater Task" /sc monthly /d /st 15:00:00 /tr "C:\Windows\Tasks\AutoTeXLivePackageUpdaterMonthly.bat"

:run
echo ============================开始============================
echo Writen By 有龙则灵_USTB

echo 是否更新TeXLive Package？
set Choice=
set /p Choice=请输入：y/n?
IF "%Choice%"=="y" (goto ya) else (goto n)

:ya
call tlmgr option repository http://mirror.ctan.org/systems/texlive/tlnet
echo ============================更新tlmgr============================
echo Writen By 有龙则灵_USTB
call tlmgr update --self
echo ============================显示待更新的宏包以及可自动安装的项============================
call tlmgr update --list
echo Writen By 有龙则灵_USTB

echo 是否更新TeXLive Package？
set Choice=
set /p Choice=请输入：y/n?
IF "%Choice%"=="y" (goto yb) else (goto n)

:yb
echo ============================更新所有宏包============================
call tlmgr update --all
echo ============================结束============================
echo Writen By 有龙则灵_USTB
pause
:n
\end{verbatim}

\begin{itemize}

\item
  脚本阐释

  \begin{itemize}

  \item
    利用 Windows 自带的 SchTasks 创建定时任务
  \end{itemize}
\end{itemize}

第一部分用于将该脚本移动到定时任务的根目录，并创建一个计划任务项。
为什么不用 AT 呢？因为 AT 在 Win10 中已经被取缔了。

\begin{verbatim}
if exist "C:\Windows\Tasks\autoTeXLivePackageUpdaterMonthly.bat" goto run

move /y %0 "C:\Windows\Tasks"
schtasks /delete /tn "TeXLivePackage Updater Task" /f
schtasks /create /tn "TeXLivePackage Updater Task" /sc monthly /d /st 15:00:00 /tr "C:\Windows\Tasks\TeXLivePackageUpdater.bat"
\end{verbatim}

更多关于计划任务的操作，可以去搜索，也可以参考\href{https://www.flighty.cn/html/tutorial/20170406_442.html}{这篇文章}。
* 调用 tlmgr 进行更新

第二部分是调用 tlmgr 进行更新TeXLive宏包。

\begin{verbatim}
tlmgr option repository http://mirror.ctan.org/systems/texlive/tlnet
tlmgr update --self
tlmgr update --list
tlmgr update --all --no-auto-install
\end{verbatim}

以上四条命令分别实现的是\textbf{选取宏包源}、\textbf{更新 tlmgr 自身}、
\textbf{列出可更新的宏包名}、\textbf{更新所有宏包}。
--no-auto-install 实现的是不自动安装。众所周知 \TeXLive{}
是发行几乎所有投稿的宏包，所有每次更新里面都有太多自动安装的宏包。如果你想要这个功能，删掉这个参数即可。
更多关于 tlmgr 的操作，请参考\href{https://www.tug.org/texlive/doc/tlmgr.html}{官方文档}。
* 批处理编写

代码里面其余部分均是 bat
编程的基本语句，可参考\href{https://baike.baidu.com/item/\%E6\%89\%B9\%E5\%A4\%84\%E7\%90\%86/1448600?fr=aladdin}{百度百科}。


\faq{不同平台 \LaTeX{} 编辑器推荐}{editors}

用户编写的 tex 文件，本质上是文本文件，因此很多编辑器都可以对 tex 文件进行更改。
某些编辑器，如 Notepad++，VSCode，Sublime Text 等，还对 tex 文件进行了语法高亮，
甚至可以利用插件做成一个 IDE。

TeXworks 是集成在 \TeXLive{} 和 \MiKTeX{} 中的编辑器（\MacTeX{} 则集成了类似的 TeXShop），
轻量简洁，适合新手学习。

TeXStudio 是一款跨平台的开源 \LaTeX{} IDE(集成开发环境)。
对于大部分用户而言，它的功能足以满足需要，下载可访问官网 \url{http://texstudio.sourceforge.net/}。

Texmaker 是一款免费、现代、跨平台的 \LaTeX{} 编辑器。 它能够在 Linux，macOS 和 Windows 系统中使用，
并且将很多开发 \LaTeX{} 文件的工具集成在了一个应用当中。
详情见官网：\url{http://www.xm1math.net/texmaker/}。

WinEdt 是一款功能强大且多样的 Windows 专用文本编辑器，具有很强的创建和编辑 \LaTeX{} 文档的能力，
可与TeX系统（如\MiKTeX{}或 \TeXLive{}）无缝集成。详情见官网：\url{http://www.winedt.com/}。

Texpad 是运行于 macOS/iOS 在线平台的编辑器，带自动编译，支持多人联合编辑，更多内容可访问
\url{https://www.texpad.com}

Visual Studio Code（vscode），是一款强大的跨平台编辑器。
安装 LaTeX Workshop 插件后就可以尽享 tex 编程乐趣，界面比较美观，适合 Windows 平台。
软件下载可见官网 \url{https://code.visualstudio.com/}。
配置可参考下面网址 \url{http://www.latexstudio.net/archives/11087.html}。


\faq{如何在 Sublime 上配置 \LaTeX{} 编译环境}{sublime-latex}

可以参考 LaTeXTools 插件的安装教程，具体安装方法可见 \url{http://www.qhjack.cn/blog/1792.html}。
如果只是配置最简单的 LaTeXTools （如果已经安装好\TeXLive{}，Subline Text 3 和 Sumatra PDF），
也可以参考 \url{https://blog.csdn.net/qazxswed807/article/details/51234834}。


\faq{\LaTeX{} 文档能转成 Microsoft Word 格式吗}{tex2word}

严格来讲，可以做，例如利用 pandoc。但十分不建议这样做。
有时候投稿A期刊被拒，修改后转投B期刊，两者要求的稿件格式偶尔会有差异，就会遇到这样的格式转换问题。可以试试pandoc，也可以试试商业软件tex2word和word2tex，如果原来的文档书写规范，转换效果还是可以接受的，只要略作微调就可以使用。问题是遇到这样情况的时候，原来文档格式往往是很不规范的，结果就悲剧了。


\faq{新手应该选择什么发行版，什么编辑器最省心}{tex-beginner}

其实选择什么发行版都可以啦，只不过大家说的最多的是 \TeXLive{}，其次是 \MiKTeX{}。
编辑器也随意，像 \TeXLive{} 和 \MiKTeX{} 里自带的 TeXworks，
第三方的 TeXMaker，TeXStudio 等都是免费的编辑器。
有付费习惯的 Windows 用户也可以选择 WinEdt。
Mac 用户通常使用的是 \MacTeX{}，它里面集成了 TeXShop 编辑器。


\faq{清华大学的 \TeXLive{} 镜像没有其他语言版?}{}

别说清华大学的没有，其他镜像的也没有。\TeXLive{} 本身不存在语言的问题。
对于一般用户而言，能通过命令行调用 \TeXLive{} 的引擎的人都不多，命令行需要尽量避开中文。
你可能好奇的是编辑器如何变成中文。这个需要看编辑器本身的设置。


\faq{TeXStudio 怎么自定义快捷键？}{}

options $\to$ configure texstudio $\to$ shortcuts


\faq{有哪些支持实时刷新的 pdf 阅读器？}{}

\begin{itemize}
  \item Windows 下可以使用 \href{https://www.sumatrapdfreader.org/free-pdf-reader.html}{SumatraPDF}
  \item Mac 下可以使用 \href{http://skim-app.sourceforge.net/}{Skim}。
  \item Linux 下的 \href{https://gitlab.gnome.org/GNOME/evince}{Evince} 也支持实时更新 pdf。
\end{itemize}


\faq{不同编辑器和不同 pdf 阅读器如何设置正反向搜索？}{}

配置 Sublime Text：
\begin{itemize}
  \item
    手写编译命令：
\begin{verbatim}
{
    "shell_cmd": "xelatex -synctex=1 \"${file}\" && evince \"$file_base_name.pdf\"",
}
\end{verbatim}
    说明： 添加 |-synctex=1| 参数生成 \file{synctex.gz} 文件，以支持正反向搜索。
    |evince "$file_base_name.pdf"| 用 Evince 文档查看器打开生成的 PDF 文档，
    或者你可以换成其它 PDF 查看器。
    |$file_base_name| 获取不包括后缀的文件名。
    两条命令需要前面执行完正确再执行后面，用 |&&| 分隔开。
  \item
    通过 Package Control 安装插件 LaTeXTools。
    TeXStudio不用配置，只需要按住 Ctrl，鼠标左键分别点击代码窗口和内置 pdf 阅读器页面，
    会分别定位到 pdf 和代码窗口。
\end{itemize}


\faq{使用 \pkg{minted} 之前要如何配置环境？}{}

详细的配置在 \pkg{minted} 宏包文档中有介绍。
安装 python，选定安装 pip。打开命令行，执行
\begin{verbatim}
setx path=%path%;[Python];[\Python\Scripts]
\end{verbatim}
这里的 |[Python]| 和 |[\Python\Scripts]| 代指你安装 python 的路径和该路径下的 scripts 文件夹。
如 |D:\Python\Python36| 和 |D:\Python\Python36\Scripts|。
然后下载 \file{Pygments.whl} （见网址 \url{http://pygments.org/download/}），在命令行中执行
\begin{verbatim}
pip install [pygments.whl]
\end{verbatim}

注意 |[pygments.whl]| 指代用户下载的 whl 文件名，如 \file{Pygments-2.2.0-py2.py3-none-any.whl}。
安装完毕，即可调用 |-shell-escape| 参数编译包含 \pkg{minted} 的源文件。

选定安装，装完后，打开命令行，输入 |pip install pygments| 回车，装完，
最后在编译文档的时候添加 |-shell-escape| 选项。


\faq{\TeXLive{}为什么要采取每年一个大版本的制度？跨版本更新怎么做？UI字体为什么那么丑}{}


\faq{在经常使用某个非 CTAN 收录的宏包的情况下。怎样安装这种非字体宏包？}{}


\faq{怎样安装字体宏包？}{}


\faq{为了预防 \TeX{} 源文件用不同的编辑器，不同的系统下打开，产生乱码，无法撤回修改，有什么建议？}{}

用 UTF-8 编码就好了


\faq{TeXStudio 里面某些命令明明没有打错，也可以正常编译，为什么编辑框会显示为红的？}{}

编辑器里面并没有把所有的命令都写入它的格式文件，仅此而已。


\faq{\TeXLive{}怎么手动添加其他宏包？}{}

一般而言 \TeXLive{} 默认把宏包都安装在本地，如果是用户自定义的宏包，只需放置于工作目录。


\faq{在 macOS 系统下怎么配置中文，很多中文模板用不了？}{}


\faq{WinEdt 编辑器中如何搜索并高亮出全部的关键词？自己尝试只标记出一个来。}{}


\faq{不同IDE写的源文档相互编译会不会出现不兼容情况？比如用 WinEdt 写的文档，用 xelatex 编译，当文档换到TeXstudio中也用xelatex编译时会不会出现兼容性的错误?}{}

只要文档编码、编译引擎一致，就不会出问题。
使用命令行。同时按下 win 键和 R 键，打开“运行”窗口，在窗口的“打开”处，
